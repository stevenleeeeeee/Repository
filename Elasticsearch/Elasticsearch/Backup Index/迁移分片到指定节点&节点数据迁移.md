#### 将旧节点索引分片迁移至新节点
```bash
curl -XPOST '192.168.xx.xx:9200/_cluster/reroute' -d '{  
    "commands" : [ {  
        "move" :   
            {  
              "index" : "test", "shard" : 2,   
              "from_node" : "node1", "to_node" : "node2"  
            }  
        }
    ]  
}'
```

#### 节点数据迁移
```bash
# 把这个节点上的所有分片都自动转移到其他节点上，等到转移完成，这个空节点就可以毫无影响的下线
# https://www.elastic.co/guide/en/elasticsearch/reference/7.4/shard-allocation-filtering.html

curl -XPUT 127.0.0.1:9200/_cluster/settings -d '{
    "transient" :{
        "cluster.routing.allocation.exclude._ip" : "10.0.0.1"
        }
}'

# The index allocation settings support the following built-in attributes: ( 可用的排除属性如下)
# _name       Match nodes by node name <--- eg: "cluster.routing.allocation.exclude.._name": "node1,node2,node3"
# _host_ip    Match nodes by host IP address (IP associated with hostname)
# _publish_ip Match nodes by publish IP address
# _ip         Match either _host_ip or _publish_ip
# _host       Match nodes by hostname

# 当shard都迁移走后，就可以将此机器上的ES进程关闭
# 可以在管理页面上删除此节点的ES服务角


# #排除写入某节点（不必要的参数要省略掉）
# #index.routing.allocation.require.	【必须】
# #index.routing.allocation.include. 	【允许】
# #index.routing.allocation.exclude.	【排除】
# "settings": {
#   "index":{
#     "routing":{
#       "allocation":{
#         "exclude":{
#           "_ip": "192.168.157.19"
#         },
#         "total_shards_per_node": "5"
#       }
#     },
#   "refresh_interval":"60s",
#   "number_of_shards":"200",
#   "provided_name":"log4x_trace_2018_11_24",
#   "creation_date":"1542988801497",
#   "number_of_replicas":"0",
#   "uuid":"kjsdfhjksdhfjksdhjfhsdfsdjkfhsdjk",
#   "version":{
#     "created":"5050099"
#   }
#   }
# }

```