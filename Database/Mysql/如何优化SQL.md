#### 关于优化
```txt
从几个方面优化
　　成本由低到高，效果却由高到低：SQL及索引 –> 数据库表结构 –> 系统配置 –> 硬件

如何优化
　　1. 观察，至少跑1天，看看生产的慢SQL情况
　　2. 开启慢查询日志，设置阀值，比如超过5秒钟的就是慢SQL，并将它抓取出来
　　3. explain+慢SQL分析
　　4. show profile
　　5. 运维经理 Or DBA, 进行SQL数据库服务器的参数调优
 
总结
　　1. 慢查询的开启并捕获
　　2. explain+慢SQL分析
　　3. show profile查询SQL在MySQL服务器里面的执行细节和生命周期情况
　　4. SQL数据库服务器的参数调优。
```
#### 关于索引
```txt
哪些情况需要创建索引
　　1. 主键自动建立唯一索引
　　2. 频繁作为查询查询条件的字段应该创建索引
　　3. 查询中与其它表关联的字段，外键关系建立索引
　　4. 频繁更新的字段不适合创建索引
　　5. where条件里用不到的字段不创建索引
　　6. 单键/组合索引的选择问题(在高并发下倾向创建组合索引)
　　7. 查询中排序的字段，排序字段若通过索引去访问将大大提高排序速度
　　8. 查询中统计或者分组字段

哪些情况不要创建索引
　　1. 表记录太少
　　2. 经常增删改的表(因为不仅要保存数据，还要保存一下索引文件)
　　3. 数据重复且分布平均的表字段，因此应该只为最经常查询和最经常排序的数据列建立索引。
　　注意：如果某个数据列包含许多重复的内容，为它建立索引就没有太大的实际效果。
```
#### mysqldumpslow
```txt
mysqldumpslow --help
　　s:   表示按何种方式排序
　　c:   访问次数
　　l:   锁定时间
　　r:   返回记录
　　t:   查询时间
　　al:  平均锁定时间
　　ar:  平均返回记录数
　　at:  平均查询时间
　　t:   返回前面多少条的数据
　　g:   后边搭配一个正则匹配模式，大小写不敏感的

得到返回记录集最多的10个SQL
mysqldumpslow -s r -t 10 /var/lib/mysql/show.log

得到访问次数最多的10个SQL
mysqldumpslow -s c -t 10 /var/lig/mysql/show.log

得到按照时间排序的前10条里面含有左连接的查询语句
mysqldumpslow -s t -t 10 -g "left join" /var/lig/mysql/show.log

另外建议在使用这些命令时结合|与more，否则有可能刷屏
mysqldumpslow -s r -t 10 /var/lig/mysql/show.log | more
```
